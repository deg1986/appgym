<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="description" content="Plan de entrenamiento de 8 semanas">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <title>Plan de Entrenamiento</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            padding-bottom: 80px;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
        }
        .header {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        h1 {
            color: #333;
            font-size: 28px;
            margin-bottom: 10px;
        }
        .subtitle {
            color: #666;
            font-size: 14px;
        }
        .week-selector {
            margin: 20px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        select {
            padding: 10px 15px;
            border: 2px solid #667eea;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            color: #667eea;
            cursor: pointer;
            background: white;
        }
        .progress-info {
            background: #e0e7ff;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
        }
        .progress-bar-container {
            background: #d1d5db;
            height: 12px;
            border-radius: 20px;
            overflow: hidden;
            margin-top: 10px;
        }
        .progress-bar {
            background: #667eea;
            height: 100%;
            transition: width 0.3s;
        }
        .day-card {
            background: white;
            border-radius: 12px;
            margin-bottom: 15px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .day-card.completed {
            background: #f0fdf4;
        }
        .day-header {
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
        }
        .check-btn {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            border: 3px solid #d1d5db;
            background: white;
            cursor: pointer;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        .check-btn.checked {
            background: #10b981;
            border-color: #10b981;
            color: white;
        }
        .day-info {
            flex: 1;
        }
        .day-name {
            font-size: 20px;
            font-weight: bold;
            color: #1f2937;
        }
        .day-type {
            font-size: 14px;
            color: #6b7280;
        }
        .day-duration {
            font-size: 12px;
            color: #667eea;
            font-weight: bold;
        }
        .exercises {
            padding: 0 20px 20px 20px;
            border-top: 1px solid #e5e7eb;
            display: none;
        }
        .exercises.show {
            display: block;
        }
        .exercise-item {
            background: #f9fafb;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
        }
        .exercise-name {
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 5px;
        }
        .exercise-time {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 8px;
        }
        .exercise-desc {
            font-size: 13px;
            color: #4b5563;
            margin-top: 8px;
            padding: 10px;
            background: white;
            border-radius: 5px;
            display: none;
        }
        .exercise-desc.show {
            display: block;
        }
        .show-desc-btn, .show-video-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 12px;
            cursor: pointer;
            margin-right: 5px;
            margin-top: 5px;
            text-decoration: none;
            display: inline-block;
        }
        .show-video-btn {
            background: #ef4444;
        }
        .postural {
            background: #fef3c7;
            border: 2px solid #fbbf24;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }
        .postural h3 {
            color: #92400e;
            margin-bottom: 15px;
        }
        .postural li {
            color: #92400e;
            margin: 8px 0;
            margin-left: 20px;
        }
        .expand-icon {
            color: #9ca3af;
            font-size: 20px;
        }
        .install-banner {
            background: #10b981;
            color: white;
            padding: 15px;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 15px;
            display: none;
        }
        .install-banner button {
            background: white;
            color: #10b981;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="install-banner" id="installBanner">
            <p>üì± Instala esta app en tu celular</p>
            <button onclick="installApp()">Instalar</button>
        </div>

        <div class="header">
            <h1>Plan de Entrenamiento</h1>
            <p class="subtitle">8 semanas - Reincorporaci√≥n progresiva</p>
            
            <div class="week-selector">
                <label style="font-weight: bold;">Semana actual:</label>
                <select id="weekSelector" onchange="changeWeek()">
                    <option value="1">Semana 1</option>
                    <option value="2">Semana 2</option>
                    <option value="3">Semana 3</option>
                    <option value="4">Semana 4</option>
                    <option value="5">Semana 5</option>
                    <option value="6">Semana 6</option>
                    <option value="7">Semana 7</option>
                    <option value="8">Semana 8</option>
                </select>
            </div>

            <div class="progress-info" id="progressInfo">
                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                    <strong>Semanas 1-2</strong>
                    <span id="progressPercent">0%</span>
                </div>
                <p id="progressText" style="font-size: 14px; margin-bottom: 10px;">Carga ligera, t√©cnica perfecta, 3 rondas</p>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="progressBar" style="width: 0%"></div>
                </div>
            </div>
        </div>

        <div id="daysContainer"></div>

        <div class="postural">
            <h3>üîî Rutina Postural Diaria (10 min)</h3>
            <ul>
                <li>Retracciones escapulares: 3√ó12</li>
                <li>Estiramiento de pectoral: 3√ó30s por lado</li>
                <li>Extensiones tor√°cicas: 2 min</li>
                <li>Caminata corta cada 90 min en el trabajo</li>
            </ul>
        </div>
    </div>

    <script>
        const plan = {
            'Lunes': {
                tipo: 'Fuerza: Tren superior + Core',
                duracion: '40-50 min',
                ejercicios: [
                    {nombre: 'Press de hombros con mancuernas', tiempo: '40s / 20s descanso', desc: 'Parado, pies ancho de hombros. Mancuernas a altura de hombros, palmas al frente. Empuja hacia arriba extendiendo brazos. Baja controlado.', video: 'https://youtu.be/qEwKCR5JCog'},
                    {nombre: 'Remo con mancuerna a una mano', tiempo: '40s / 20s descanso', desc: 'Apoya rodilla y mano en banco. Mancuerna cuelga. Tira hacia cadera, codo pegado al cuerpo. Alterna brazos.', video: 'https://youtu.be/roCP6wCXPqo'},
                    {nombre: 'Press banca con mancuernas', tiempo: '40s / 20s descanso', desc: 'Acostado en banco. Mancuernas a altura pecho. Empuja hacia arriba. Baja controlado hasta pecho.', video: 'https://youtu.be/VmB1G1K7v94'},
                    {nombre: 'Curl de b√≠ceps', tiempo: '40s / 20s descanso', desc: 'Parado, brazos extendidos. Flexiona codos llevando mancuernas a hombros. Mant√©n codos fijos.', video: 'https://youtu.be/ykJmrZ5v0Oo'},
                    {nombre: 'Tr√≠ceps con mancuerna', tiempo: '40s / 20s descanso', desc: 'Parado, mancuerna con ambas manos sobre cabeza. Flexiona codos bajando peso detr√°s. Extiende.', video: 'https://youtu.be/nRiJVZDpdL0'},
                    {nombre: 'Plancha', tiempo: '30-45s / 20s descanso', desc: 'Apoya antebrazos y puntas de pies. Cuerpo recto como tabla. Activa abdomen. Mant√©n posici√≥n.', video: 'https://youtu.be/ASdvN_XEl_c'}
                ],
                rondas: '3-4 rondas'
            },
            'Martes': {
                tipo: 'Caminata r√°pida',
                duracion: '30-45 min',
                ejercicios: [
                    {nombre: 'Caminata a ritmo moderado-r√°pido', tiempo: '30-45 min', desc: 'Camina a paso firme donde puedas hablar pero con algo de esfuerzo. Brazos en movimiento natural.', video: 'https://youtu.be/L3z1f9cJLo4'}
                ]
            },
            'Mi√©rcoles': {
                tipo: 'Fuerza: Tren inferior + Movilidad',
                duracion: '40-50 min',
                ejercicios: [
                    {nombre: 'Sentadilla con barra o mancuernas', tiempo: '40s / 20s descanso', desc: 'Pies ancho hombros. Baja como si te sentaras, rodillas no pasan puntas pies. Sube empujando talones.', video: 'https://youtu.be/eMYjBnIVb_A?si=f9UhDYmW1kGdPKX2'},
                    {nombre: 'Peso muerto con mancuernas', tiempo: '40s / 20s descanso', desc: 'Pies juntos, mancuernas al frente. Bisagra de cadera, baja mancuernas por piernas. Sube apretando gl√∫teos.', video: 'https://youtu.be/lJ3QwaXNJfw'},
                    {nombre: 'Zancadas hacia atr√°s', tiempo: '40s / 20s descanso', desc: 'Parado, da paso largo atr√°s. Baja rodilla casi al piso. Vuelve posici√≥n inicial. Alterna piernas.', video: 'https://youtu.be/xNNVLAC_yjY'},
                    {nombre: 'Puente de gl√∫teos', tiempo: '40s / 20s descanso', desc: 'Acostado boca arriba, rodillas flexionadas. Empuja cadera arriba apretando gl√∫teos. Baja controlado.', video: 'https://youtu.be/wPM8icPu6H8'},
                    {nombre: 'Elevaci√≥n de gemelos', tiempo: '40s / 20s descanso', desc: 'Parado, sube en puntas de pies. Mant√©n arriba 1 seg. Baja controlado.', video: 'https://youtu.be/gwLzBJYoWlI'},
                    {nombre: 'Movilidad de cadera y lumbar', tiempo: '8 min', desc: 'Gato-camello: 4 apoyos, arquea y redondea espalda. Estocada baja: rodilla al piso, empuja cadera adelante.', video: 'https://youtu.be/K9bK0jbKmLM'}
                ],
                rondas: '3-4 rondas'
            },
            'Jueves': {
                tipo: 'Caminata r√°pida o bici',
                duracion: '30-45 min',
                ejercicios: [
                    {nombre: 'Caminata o bicicleta', tiempo: '30-45 min', desc: 'Cardio suave a moderado. Mant√©n ritmo constante.', video: 'https://youtu.be/L3z1f9cJLo4'}
                ]
            },
            'Viernes': {
                tipo: 'Full Body',
                duracion: '40-50 min',
                ejercicios: [
                    {nombre: 'Sentadilla goblet con mancuerna', tiempo: '40s / 20s descanso', desc: 'Mancuerna al pecho con ambas manos. Sentadilla normal manteniendo peso pegado.', video: 'https://youtu.be/MeIiIdhvXT4'},
                    {nombre: 'Remo con barra', tiempo: '40s / 20s descanso', desc: 'Inclinado 45¬∞, barra cuelga. Tira hacia ombligo, codos atr√°s. Aprieta esc√°pulas.', video: 'https://youtu.be/FWJR5Ve8bnQ'},
                    {nombre: 'Press militar', tiempo: '40s / 20s descanso', desc: 'Parado, barra a altura clav√≠culas. Empuja arriba pasando por delante de cara.', video: 'https://youtu.be/2yjwXTZQDDI'},
                    {nombre: 'Peso muerto rumano', tiempo: '40s / 20s descanso', desc: 'Piernas semi-extendidas. Baja barra por piernas hasta media pantorrilla. Sube con gl√∫teos.', video: 'https://youtube.com/shorts/5rIqP63yWFg?si=w2JS7wzUTeqBMMqj'},
                    {nombre: 'Plancha lateral', tiempo: '30s/lado / 20s descanso', desc: 'De lado, apoyo en antebrazo y pie. Cuerpo recto. Mant√©n cadera arriba.', video: 'https://youtu.be/K2VljzCC4lg'},
                    {nombre: 'Bird-dog', tiempo: '40s / 20s descanso', desc: '4 apoyos. Extiende brazo derecho y pierna izquierda. Mant√©n equilibrio. Alterna.', video: 'https://youtu.be/wiFNA3sqjCA'}
                ],
                rondas: '3-4 rondas'
            },
            'S√°bado': {
                tipo: 'Caminata recreativa o estiramientos',
                duracion: '30 min',
                ejercicios: [
                    {nombre: 'Actividad ligera', tiempo: '30 min', desc: 'Estiramiento general o caminata tranquila para recuperaci√≥n activa.', video: 'https://youtu.be/g_tea8ZNk5A'}
                ]
            },
            'Domingo': {
                tipo: 'Descanso completo',
                duracion: '-',
                ejercicios: []
            }
        };

        const weekGuides = {
            1: {text: 'Semanas 1-2', desc: 'Carga ligera, t√©cnica perfecta, 3 rondas', color: '#dbeafe'},
            2: {text: 'Semanas 1-2', desc: 'Carga ligera, t√©cnica perfecta, 3 rondas', color: '#dbeafe'},
            3: {text: 'Semanas 3-4', desc: 'Aumentar 10% carga o 1 ronda extra', color: '#d1fae5'},
            4: {text: 'Semanas 3-4', desc: 'Aumentar 10% carga o 1 ronda extra', color: '#d1fae5'},
            5: {text: 'Semanas 5-6', desc: 'A√±adir 1 ejercicio + mayor velocidad', color: '#fef3c7'},
            6: {text: 'Semanas 5-6', desc: 'A√±adir 1 ejercicio + mayor velocidad', color: '#fef3c7'},
            7: {text: 'Semanas 7-8', desc: 'Series pesadas 5-6 reps en primer ejercicio', color: '#fed7aa'},
            8: {text: 'Semanas 7-8', desc: 'Series pesadas 5-6 reps en primer ejercicio', color: '#fed7aa'}
        };

        let deferredPrompt;
        let progress = {};
        let currentWeek = 1;

        // PWA Install
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            document.getElementById('installBanner').style.display = 'block';
        });

        function installApp() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        document.getElementById('installBanner').style.display = 'none';
                    }
                    deferredPrompt = null;
                });
            }
        }

        // Registrar Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js');
        }

        function loadProgress() {
            const saved = localStorage.getItem('trainingProgress');
            return saved ? JSON.parse(saved) : {};
        }

        function saveProgress(data) {
            localStorage.setItem('trainingProgress', JSON.stringify(data));
        }

        function loadWeek() {
            const saved = localStorage.getItem('currentWeek');
            return saved ? parseInt(saved) : 1;
        }

        function saveWeek(week) {
            localStorage.setItem('currentWeek', week.toString());
        }

        function getToday() {
            return new Date().toLocaleDateString();
        }

        function toggleDay(day) {
            const key = `${getToday()}-${day}`;
            progress[key] = !progress[key];
            saveProgress(progress);
            updateProgress();
            renderDays();
        }

        function isDayCompleted(day) {
            const key = `${getToday()}-${day}`;
            return progress[key] || false;
        }

        function calculateProgress() {
            const today = getToday();
            const completed = Object.keys(progress).filter(k => k.startsWith(today) && progress[k]).length;
            const total = Object.keys(plan).filter(d => plan[d].ejercicios.length > 0).length;
            return Math.round((completed / total) * 100);
        }

        function updateProgress() {
            const percent = calculateProgress();
            document.getElementById('progressPercent').textContent = percent + '%';
            document.getElementById('progressBar').style.width = percent + '%';
        }

        function changeWeek() {
            currentWeek = parseInt(document.getElementById('weekSelector').value);
            saveWeek(currentWeek);
            const guide = weekGuides[currentWeek];
            document.getElementById('progressInfo').style.backgroundColor = guide.color;
            document.getElementById('progressInfo').querySelector('strong').textContent = guide.text;
            document.getElementById('progressText').textContent = guide.desc;
        }

        function toggleExercises(day) {
            const elem = document.getElementById(`exercises-${day}`);
            const icon = document.getElementById(`icon-${day}`);
            if (elem.classList.contains('show')) {
                elem.classList.remove('show');
                icon.textContent = '‚ñº';
            } else {
                elem.classList.add('show');
                icon.textContent = '‚ñ≤';
            }
        }

        function toggleDesc(day, idx) {
            const elem = document.getElementById(`desc-${day}-${idx}`);
            const btn = document.getElementById(`btn-${day}-${idx}`);
            if (elem.classList.contains('show')) {
                elem.classList.remove('show');
                btn.textContent = 'Ver t√©cnica';
            } else {
                elem.classList.add('show');
                btn.textContent = 'Ocultar';
            }
        }

        function renderDays() {
            const container = document.getElementById('daysContainer');
            const days = ['Lunes', 'Martes', 'Mi√©rcoles', 'Jueves', 'Viernes', 'S√°bado', 'Domingo'];
            
            container.innerHTML = days.map(day => {
                const info = plan[day];
                const completed = isDayCompleted(day);
                const hasExercises = info.ejercicios.length > 0;
                
                return `
                    <div class="day-card ${completed ? 'completed' : ''}">
                        <div class="day-header" onclick="${hasExercises ? `toggleExercises('${day}')` : ''}">
                            <div class="check-btn ${completed ? 'checked' : ''}" onclick="event.stopPropagation(); toggleDay('${day}')">
                                ${completed ? '‚úì' : ''}
                            </div>
                            <div class="day-info">
                                <div class="day-name">${day}</div>
                                <div class="day-type">${info.tipo}</div>
                                ${info.duracion !== '-' ? `<div class="day-duration">${info.duracion}</div>` : ''}
                            </div>
                            ${hasExercises ? `<span class="expand-icon" id="icon-${day}">‚ñº</span>` : ''}
                        </div>
                        ${hasExercises ? `
                            <div class="exercises" id="exercises-${day}">
                                ${info.rondas ? `<p style="font-weight: bold; color: #667eea; margin: 15px 0 10px 0;">${info.rondas}</p>` : ''}
                                ${info.ejercicios.map((ej, idx) => `
                                    <div class="exercise-item">
                                        <div class="exercise-name">${ej.nombre}</div>
                                        <div class="exercise-time">‚è±Ô∏è ${ej.tiempo}</div>
                                        <button class="show-desc-btn" id="btn-${day}-${idx}" onclick="toggleDesc('${day}', ${idx})">Ver t√©cnica</button>
                                        ${ej.video ? `<a href="${ej.video}" target="_blank" class="show-video-btn">‚ñ∂Ô∏è Ver video</a>` : ''}
                                        <div class="exercise-desc" id="desc-${day}-${idx}">${ej.desc}</div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        // Inicializar
        progress = loadProgress();
        currentWeek = loadWeek();
        document.getElementById('weekSelector').value = currentWeek;
        changeWeek();
        renderDays();
        updateProgress();
    </script>
</body>
</html>